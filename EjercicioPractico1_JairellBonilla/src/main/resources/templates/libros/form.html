<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout::page(~{::section})}">
<section>
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0" th:text="${#fields.hasErrors()} ? 'Corregir libro' : ( ${libro.id} != null ? 'Editar libro' : 'Nuevo libro' )">Nuevo libro</h2>
    <a th:href="@{/libros}" class="btn btn-outline-secondary">Volver</a>
  </div>

  <form th:action="@{/libros/guardar}" th:object="${libro}" method="post" class="needs-validation" novalidate>
    <input type="hidden" th:field="*{id}"/>

    <div class="form-row">
      <div class="form-group col-md-8">
        <label for="titulo">Título</label>
        <input id="titulo" type="text" class="form-control" th:field="*{titulo}" required>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('titulo')}" th:errors="*{titulo}">Requerido</div>
      </div>
      <div class="form-group col-md-4">
        <label for="autor">Autor</label>
        <input id="autor" type="text" class="form-control" th:field="*{autor}" required>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('autor')}" th:errors="*{autor}">Requerido</div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group col-md-4">
        <label for="isbn">ISBN</label>
        <input id="isbn" type="text" class="form-control" th:field="*{isbn}">
      </div>
      <div class="form-group col-md-4">
        <label for="categoria">Categoría</label>
        <select id="categoria" class="form-control" th:field="*{categoria.id}" required>
          <option value="" disabled th:selected="${libro.categoria} == null">Seleccione…</option>
          <option th:each="c : ${categorias}" th:value="${c.id}" th:text="${c.nombre}"></option>
        </select>
        <div class="invalid-feedback" th:if="${#fields.hasErrors('categoria')}" th:errors="*{categoria}">Requerido</div>
      </div>
      <div class="form-group col-md-4">
        <label for="fecha_publicacion">Fecha de publicación</label>
        <input id="fecha_publicacion" type="date" class="form-control" th:field="*{fechaPublicacion}">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group col-md-8">
        <label for="descripcion">Descripción</label>
        <textarea id="descripcion" rows="3" class="form-control" th:field="*{descripcion}"></textarea>
      </div>
      <div class="form-group col-md-2">
        <label for="precio">Precio</label>
        <input id="precio" type="number" step="0.01" min="0" class="form-control" th:field="*{precio}">
      </div>
      <div class="form-group col-md-2 d-flex align-items-center">
        <div class="form-check mt-4">
          <input id="disponible" type="checkbox" class="form-check-input" th:field="*{disponible}">
          <label class="form-check-label" for="disponible">Disponible</label>
        </div>
      </div>
    </div>

    <div class="text-right">
      <button type="submit" class="btn btn-primary">Guardar</button>
    </div>
  </form>
</section>
</html>
