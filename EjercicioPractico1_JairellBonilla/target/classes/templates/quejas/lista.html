<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout::page(~{::section})}">
<section>
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Quejas / Sugerencias</h2>
    <a th:href="@{/quejas/nueva}" class="btn btn-primary">Nueva</a>
  </div>

  <div th:if="${msg}" class="alert alert-success" th:text="${msg}"></div>

  <table class="table table-striped table-hover">
    <thead>
    <tr>
      <th>#</th>
      <th>Cliente</th>
      <th>Tipo</th>
      <th>Asunto</th>
      <th>Fecha</th>
      <th>Estado</th>
      <th class="text-right">Acciones</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="q : ${quejas}">
      <td th:text="${q.id}">1</td>
      <td>
        <div th:text="${q.nombreCliente}">Juan</div>
        <small class="text-muted" th:text="${q.email}">email</small>
      </td>
      <td th:text="${q.tipo}">QUEJA</td>
      <td th:text="${q.asunto}">Asunto</td>
      <td th:text="${#temporals.format(q.createdAt, 'yyyy-MM-dd HH:mm')}">2025-01-01</td>
      <td>
        <span th:text="${q.tratado} ? 'Tratado' : 'Pendiente'"
              th:classappend="${q.tratado} ? 'badge badge-success' : 'badge badge-warning'">Pendiente</span>
      </td>
      <td class="text-right">
        <form th:action="@{|/quejas/${q.id}/tratada|}" method="post" th:if="${!q.tratado}" class="d-inline">
          <button class="btn btn-sm btn-success">Marcar tratada</button>
        </form>
        <form th:action="@{|/quejas/${q.id}/eliminar|}" method="post" class="d-inline"
              onsubmit="return confirm('Â¿Eliminar registro?')">
          <button class="btn btn-sm btn-danger">Eliminar</button>
        </form>
      </td>
    </tr>
    </tbody>
  </table>
</section>
</html>
